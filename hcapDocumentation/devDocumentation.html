<h1 id="hcap-developer-documentation">HCAP : Developer Documentation</h1>
<p>In this document you will find the developer documentation to set up tools related to HCAP on your system and start programing using the HCAP API.</p>
<h2 id="configuration-instructions">Configuration Instructions</h2>
<p>This section mentions the installation procedure of tools required to compile and run HCAP API.</p>
<h3 id="java-development-kit">Java Development Kit</h3>
<ol type="1">
<li>Download the file, jdk-10.0.1_linux-x64_bin.tar.gz from the following link. (Link: http://www.oracle.com/technetwork/java/javase/downloads/jdk10-downloads-4416644.html)</li>
<li>Change the directory to the location where you want to install the JDK, then move the .tar.gz archive binary to the current directory.</li>
<li><p>Unpack the tarball and install the JRE using the following. &gt; <strong>% tar zxvf jre-9.minor.security.patch_linux-x64_bin.tar.gz</strong>.</p></li>
<li><p>The Java Development Kit files are installed in a directory called jre-9.minor.security.patch.</p></li>
<li><p>For detailed information visit https://docs.oracle.com/javase/9/install/installation-jdk-and-jre-linux-platforms.htm#JSJIG-GUID-D54A6F28-A305-4249-A5BF-835B25644C26.</p></li>
</ol>
<h3 id="maven">Maven</h3>
<ol type="1">
<li>Check the latest tar.gz file from http://mirror.olnevhost.net/pub/apache/maven/binaries.</li>
<li><p>Suppose the file is apache-maven-3.2.1-bin.tar.gz, now from commandline run the following: &gt;<strong>wget http://mirror.olnevhost.net/pub/apache/maven/binaries/apache-maven-3.2.1-bin.tar.gz</strong></p></li>
<li>Now, lets proceed to the installation procedure.</li>
<li>Run the following command to extract the tar. &gt;<strong>tar xvf apache-maven-3.2.1-bin.tar.gz</strong></li>
<li><p>Add the environment variables such as: &gt;export M2_HOME=/usr/local/apache-maven/apache-maven-3.2.1</p></li>
</ol>
<blockquote>
<p>export M2=$M2_HOME/bin</p>
</blockquote>
<blockquote>
<p>export PATH=<span class="math inline"><em>M</em>2:</span>PATH</p>
</blockquote>
<ol start="6" type="1">
<li>Verify that maven has been successfully installed. &gt;<strong>mvn -version</strong></li>
</ol>
<h2 id="directory-structure">Directory Structure</h2>
<p>Within the HCAP project, one would find the following folders.</p>
<h3 id="keystores">KeyStores</h3>
<p>In this the user would find two files. trustStore.jks represents the trust store while keyStore.jks represents the key store used in configuring HCAP servers and clients. These stores are used by the scandium library for DTLS authentication.</p>
<h3 id="propertiesfiles">PropertiesFiles</h3>
<p>This folder contains the properties files for authorization server, resource server and the client. These properties files have some parameters used to configure the client and the servers.</p>
<h3 id="secureauthserver">SecureAuthServer</h3>
<p>This folder contains the following sub folders.</p>
<h4 id="doc">doc</h4>
<p>This folder contains the javadoc for authorization server code.</p>
<h4 id="src">src</h4>
<p>It contains the following sub folders.</p>
<ol type="1">
<li><p>ExceptionList: It contains the data structure used for storing the exception list.</p></li>
<li><p>SecureAuthServer/SecureAuthServer: It contains the actual HCAP Authorization server code.</p></li>
<li><p>StateMachines: It contains some demo state machines encoded as java class files.</p></li>
</ol>
<p>Apart from the above folders, SecureAuthServer contains important files such as Californium.properties and pom.xml.</p>
<p><em><strong>Californium.properties</strong></em> file is used by the californium library to configure the calfornium CoAP servers.</p>
<p><em><strong>pom.xml</strong></em> acts as the maven configuration file for the project. It contains all the dependencies of the project.</p>
<h3 id="secureresserver">SecureResServer</h3>
<p>This contains the following important sub folders.</p>
<h4 id="doc-1">doc</h4>
<p>This folder contains the javadoc for resource server code.</p>
<h4 id="srcmainjava">src/main/java/</h4>
<p>It contains the following sub folders.</p>
<ol type="1">
<li><p>ExceptionList: It contains the data structure used for storing the exception list.</p></li>
<li><p>SecureResServer/SecureResServer: It contains the actual resource server code.</p></li>
<li><p>ExperimentResources: It contains the code for some demo resources which can be added to the resource server. Developers wanting to write there own resources can refer to some sample files in this folder to get a head start.</p></li>
</ol>
<h4 id="srctestjavasecureresserversecureresserver">src/test/java/SecureResServer/SecureResServer</h4>
<p>This folder contains some tests for the resource server.</p>
<p>Apart from the above folders, it SecureResServer contains important files such as Californium.properties and pom.xml.</p>
<p><em><strong>Californium.properties</strong></em> file is used by the californium library to configure the calfornium CoAP servers.</p>
<p><em><strong>pom.xml</strong></em> acts as the maven configuration file for the project. It contains all the dependencies of the project.</p>
<h3 id="secureclient">SecureClient</h3>
<p>This contains the following important sub folders.</p>
<h4 id="doc-2">doc</h4>
<p>This folder contains the javadoc for client code.</p>
<h4 id="srcjavamainjavasecureclientsecureclient">src/java/main/java/SecureClient/SecureClient</h4>
<p>This folder contains the actual client code.</p>
<h4 id="srctestjavasecureclientsecureclient">src/test/java/SecureClient/SecureClient</h4>
<p>This folder contains some tests for the client.</p>
<p>Apart from the above folders, it SecureClient contains important files such as Californium.properties and pom.xml.</p>
<p><em><strong>Californium.properties</strong></em> file is used by the californium library to configure the calfornium CoAP clients.</p>
<p><em><strong>pom.xml</strong></em> acts as the maven configuration file for the project. It contains all the dependencies of the project.</p>
<h2 id="how-to-build">How to build</h2>
<h3 id="compile">Compile</h3>
<p>Go the directory containing the code for a component (authorization server, resource server or the client) you want to compile. Run the following commands.</p>
<blockquote>
<p>mvn clean</p>
</blockquote>
<blockquote>
<p>mvn compile</p>
</blockquote>
<h3 id="javadoc">Javadoc</h3>
<p>To generate javadoc, you can add the javadoc plugin in the <em>build</em> section of the pom.xml file. Eg:</p>
<pre><code>&lt;project&gt;
  ...
  &lt;build&gt;
    &lt;plugins&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
        &lt;artifactId&gt;maven-javadoc-plugin&lt;/artifactId&gt;
        &lt;version&gt;3.0.0&lt;/version&gt;
        &lt;configuration&gt;
          ...
        &lt;/configuration&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
    ...
  &lt;/build&gt;
  ...
&lt;/project&gt;</code></pre>
<p>Now run the following command</p>
<blockquote>
<p>mvn javadoc:javadoc</p>
</blockquote>
<h3 id="test">Test</h3>
<p>To run tests uning maven, go to the directory containing tests. To run all the tests inside the directory issue the following command.</p>
<blockquote>
<p>mvn test</p>
</blockquote>
<p>To run a single test i.e. testOne, issue the following command.</p>
<blockquote>
<p>mvn -Dtest=testOne test</p>
</blockquote>
<h2 id="setting-up-properties">Setting up properties</h2>
<p>Properties files in HCAP act as configuration files for each of the HCAP components. These contains important parameters needed to set up the servers and the client machine. This section mentions the parameters used in the properties files.</p>
<h3 id="authorization-server-properties-file">Authorization Server Properties File</h3>
<p>The following parameters are to be set in AuthServer.properties file.</p>
<ul>
<li><p><strong>isCBOR</strong>: Set this as true if CBOR is to be used as data transfer format or false to used JSON as data transfer format.</p></li>
<li><p><strong>trustStoreLocation</strong>: Specify the path of trust store used.</p></li>
<li><p><strong>trustStorePassword</strong>: Specify the password used for trust store.</p></li>
<li><p><strong>keyStoreLocation</strong>: Specify the path of key store used.</p></li>
<li><p><strong>keyStorePassword</strong>: Specify the password used for key store.</p></li>
<li><p><strong>port</strong>: Specify the port number here, the server would run on the port specified.</p></li>
<li><p><strong>sharedSecret</strong>: Specify this to add a shared secret shared between authorization server and resource server.</p></li>
</ul>
<h3 id="resource-server-properties-file">Resource Server Properties File</h3>
<p>The following parameters are to be set in ResServer.properties file.</p>
<ul>
<li><p><strong>authserveraddress</strong>: Specify the address of authorization server, including the port number. For eg: 127.0.0.1:5683.</p></li>
<li><p><strong>trustStoreLocation</strong>: Specify the path of trust store used.</p></li>
<li><p><strong>trustStorePassword</strong>: Specify the password used for trust store.</p></li>
<li><p><strong>keyStoreLocation</strong>: Specify the path of key store used.</p></li>
<li><p><strong>keyStorePassword</strong>: Specify the password used for key store.</p></li>
<li><p><strong>port</strong>: Specify the port number here, the server would run on the port specified.</p></li>
<li><p><strong>updateRequestCounter</strong>: This represents the soft GC threshold in HCAP. For eg: 200 means that soft GC will occur after every 400 requests to the resource server.</p></li>
<li><p><strong>hard GC Threshold</strong>: This represents the hard GC threshhold in HCAP. For eg: 400 means that hard GC will occur after ever 400 requests to the resource server.</p></li>
<li><p><strong>isCBOR</strong>: Set this as true if CBOR is to be used as data transfer format or false to used JSON as data transfer format.</p></li>
<li><p><strong>sharedSecret</strong>: Specify this to add a shared secret shared between authorization server and resource server.</p></li>
</ul>
<h3 id="client-properties-file">Client Properties File</h3>
<p>The following parameters are to be set in Client.properties file.</p>
<ul>
<li><p><strong>isCBOR</strong>: Set this as true if CBOR is to be used as data transfer format and false to used JSON as data transfer format.</p></li>
<li><p><strong>trustStoreLocation</strong>: Specify the path of trust store used.</p></li>
<li><p><strong>trustStorePassword</strong>: Specify the password used for trust store.</p></li>
<li><p><strong>keyStoreLocation</strong>: Specify the path of key store used.</p></li>
<li><p><strong>keyStorePassword</strong>: Specify the password used for key store.</p></li>
<li><p><strong>port</strong>: Specify the port number here, the server would run on the port specified.</p></li>
<li><p><strong>authserveraddress</strong>: Specify the address of authorization server, including the port number. For eg: 127.0.0.1:5683.</p></li>
<li><p><strong>resserveraddress</strong>: Specify the address of resource server, including the port number. For eg: 127.0.0.1:8080.</p></li>
</ul>
<h2 id="javadoc-location">Javadoc Location</h2>
<p>Seperate javadocs are available for the authorization server, resource server and the client. These javadocs are located in the following folders.</p>
<p><strong>Authorization Server:</strong> <em>‘HCAPDevTeam/hcap/tree/master/SecureAuthServer/doc’</em></p>
<p><strong>Resource Server:</strong> <em>‘HCAPDevTeam/hcap/tree/master/SecureResServer/doc’</em></p>
<p><strong>Client:</strong> <em>‘HCAPDevTeam/hcap/tree/master/SecureClient/doc’</em></p>
<p>For each of the above componets, <em><strong>index.html</strong></em> acts as an entry point to the API documentation.</p>
